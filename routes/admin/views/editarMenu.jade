extends ../../../views/layout
block content
  if user && user.rol == "administrador"
    #editarMenu
      h1 EDITAR MENU
      #accordion.panel-group
        - var contador = 0
        each menu in menus
          .panel.panel-primary(id="panel"+contador)
            .panel-heading(id="titulo"+contador)
              h2.panel-title #{menu.titulo}
              h3.editar.panel-title 
                a.aEditar.accordion-toggle(titulo="titulo"+contador data-toggle="collapse" data-parent="#accordion" href="#panelCollapse"+contador) Editar 
            .panel-collapse.collapse(id="panelCollapse"+contador)
              form(id="formEditarMenu"+contador method="POST" action="/admin/menu/editar")
                input(type="hidden" name="tituloMenuOriginal" value=menu.titulo)
                .panel-body
                  .datosMenu
                    .tituloMenu 
                      span Titulo 
                      input(type="text" name="tituloMenu" value=menu.titulo required title="Título requerido")
                    if !menu.submenus
                      .seleccionUrl
                        span ¿Url interna?
                        input#seleccionUrl(type="checkbox" name="seleccionUrl")
                      .urlMenu 
                        span Url 
                          input#urlExterna(type="url" placeholder="http://www.ejemplo.com" name="url")
                          select#urlInterna.form-control(style="display:none" name="url")
                            each pagina in paginas
                              option(value=pagina.nombreEnlace selected) #{pagina.titulo}
                    else 
                      .seleccionUrl(style="display:none")
                        span ¿Url interna?
                        input#seleccionUrl(type="checkbox")
                      .urlMenu(style="display:none") 
                        span Url 
                          input#urlExterna(type="url" placeholder="http://www.ejemplo.com" name="url")
                          select#urlInterna.form-control(style="display:none" name="url")
                            each pagina in paginas
                              option(value=pagina.nombreEnlace) #{pagina.titulo}
                  .creadorMenu
                    span Usuario: #{menu.UserModificacion}
                    span &nbsp; &nbsp;
                    span #{menu.fechaCreacion}
                  .acciones
                    a.agregarSubmenu(href="javascript:void(0);" tabla="tabla"+contador panel="panel"+contador) Agregar Submenu 
                    span &nbsp; | &nbsp;
                    a.eliminarMenu(href="javascript:void(0);" enlace="/admin/menu/eliminar/"+menu.titulo menu=menu.titulo) Eliminar Menu
                    span &nbsp; | &nbsp;
                    a.aCancelar(href="javascript:void(0);" panel="panel"+contador titulo="titulo"+contador panelCollapse="panelCollapse"+contador) Cancelar Edición
                if menu.submenus
                  .tituloSubmenu
                    h3 SUBMENU
                  table.table(id="tabla"+contador)
                    tr
                      td.numero 
                        h5 
                          b #
                      td.titulo 
                        h5
                          b Titulo 
                      td.check
                        h5 
                          b ¿Url Interna?
                      td.url 
                        h5
                          b Url 
                      td.fecha  
                        h5
                          b Fecha Modificación
                      td.usuario 
                        h5
                          b Usuario
                      td.accion 
                        h5
                          b Acción
                    each submenu, index in menu.submenus
                      tr.dato(id=index) 
                        td=index+1
                        td 
                          input(type="text" name="tituloSubmenu["+index+"]" value=submenu.titulo required title="Titulo de submenu requerido")
                        td 
                          input(type="checkbox" name="seleccionUrl")
                        td  
                          input(type="text" name="urlSubmenu["+index+"]" value=submenu.url required title="Url de submenu requerida") 
                        td 
                          span #{menu.fechaCreacion}
                        td 
                          span #{menu.UserModificacion}
                        td  
                          a.eliminarSubmenu(href="javascript:void(0);" onclick="cancelar_eliminarSubmenu("+index+", 'panel"+contador+"','Eliminar')") Eliminar      
                .guardarMenu
                  button.botonSubmenu.btn.btn-primary.btn-sm(type="submit" tabla="tabla"+contador) Guardar Cambios
          -contador++

      #botones
        button#agregarMenu.btn.btn-primary(type="button") Agregar Menu 
        span &nbsp; &nbsp; &nbsp;
        button.btn.btn-primary(type="button" onclick="location.href='/admin'") Regresar 

      #nuevoMenu
        #menuNuevo(style="display:none")
          form#formMenuNuevo(method="POST" action="/admin/menu/nuevo")
            #panelMenuNuevo.panel.panel-primary
                .panel-heading
                  h2.panel-title MENU NUEVO 
                .panel-collapse
                    .panel-body
                      .datosMenu
                        .tituloMenu
                          span Titulo 
                          input(type="text" name="tituloMenu" required title="Titulo requerido")
                        .seleccionUrl
                          span ¿Url interna?
                          input#seleccionUrl(type="checkbox")
                        .urlMenu
                          span Url 
                          br 
                          input#urlExterna(type="url" placeholder="http://www.ejemplo.com" name="url")
                          select#urlInterna.form-control(style="display:none" name="url")
                            each pagina in paginas
                              option(value=pagina.nombreEnlace selected) #{pagina.titulo}
                      .acciones
                        a#agregarSubmenuMenuNuevo(href="javascript:void(0);" tabla="tablaMenuNuevo" panel="panelMenuNuevo") Agregar Submenu 
                        span &nbsp; | &nbsp;
                        a#aCancelar(href="javascript:void(0);") Cancelar
                    .tituloSubmenu(style="display:none")
                      h3 SUBMENU
                    table#tablaMenuNuevo.table(style="display:none")
                      tr
                        td#numero 
                          h5 
                            b #
                        td#titulo 
                          h5
                            b Titulo 
                        td#checkbox
                          h5 
                            b ¿Url Interna?
                        td#url 
                          h5
                            b Url 
                        td#accion
                          h5
                            b Acción   
                    .guardarMenu
                      button#botonSubmenu.btn.btn-primary.btn-sm(type="submit" tabla="tablaMenuNuevo") Guardar Menu
  else
    #noAdmin 
      h1 ¡No eres administrador!  